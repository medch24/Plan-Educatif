<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-translate="portalTitle">Portail de Suivi des Devoirs</title>
    <link rel="stylesheet" href="css/devoirs.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700&family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.1/moment.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.1/locale/fr.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.1/locale/ar.js"></script>
</head>
<body>

    <div class="container">
        <!-- Vue Principale (Accueil) -->
        <div id="home-view">
            <header class="main-header">
                <div class="language-selector-home">
                    <button id="lang-fr">FranÃ§ais</button>
                    <button id="lang-ar">Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</button>
                </div>
                <h1 data-translate="portalTitle">Portail de Suivi des Devoirs</h1>
            </header>
            <main class="main-menu">
                <img src="https://lh3.googleusercontent.com/d/1lQ3Babrs3Wgv4rakVmkK0oCWcM0cTKPK" alt="Logo Ã‰cole" id="home-logo">
                <button id="go-to-parent" class="role-button" data-translate="parentSpace">Espace Parent</button>
                <button id="go-to-teacher" class="role-button" data-translate="teacherSpace">Espace Enseignant</button>
                <div class="home-showcase-container">
                    <div id="sotw-showcase" class="student-of-the-week-showcase" style="display: none;"></div>
                    <div id="photos-row" class="photos-row">
                        <div id="potd-showcase" class="photo-of-the-day-showcase" style="display: none;">
                            <h2 class="potd-title" data-translate="potdTitle">ğŸ‰ FÃ©licitations ! ğŸ‰</h2>
                            <img id="potd-image" src="" alt="Photo de fÃ©licitations" class="potd-image">
                            <p id="potd-message"></p>
                        </div>
                        <div id="photo2-showcase" class="photo-of-the-day-showcase" style="display: none;">
                            <h2 class="potd-title" data-translate="photo2Title">ğŸŒŸ Bravo ! ğŸŒŸ</h2>
                            <img id="photo2-image" src="" alt="Photo de cÃ©lÃ©bration 2" class="potd-image">
                            <p id="photo2-message"></p>
                        </div>
                        <div id="photo3-showcase" class="photo-of-the-day-showcase" style="display: none;">
                            <h2 class="potd-title" data-translate="photo3Title">ğŸ† Excellent ! ğŸ†</h2>
                            <img id="photo3-image" src="" alt="Photo de cÃ©lÃ©bration 3" class="potd-image">
                            <p id="photo3-message"></p>
                        </div>
                    </div>
                </div>
            </main>
        </div>

        <!-- Vue Espace Parent -->
        <div id="parent-selection-view" class="view" style="display: none;">
            <header>
                <button class="back-button">&larr;</button>
                <h1 data-translate="parentSpace">Espace Parent</h1>
            </header>
            <main class="parent-flow-main">
                <h2 class="section-title" data-translate="classSelectionTitle">1. Choisissez une classe</h2>
                <div id="class-buttons-container" class="class-buttons-container"></div>
                <h2 class="section-title" id="student-selection-title" data-translate="studentSelectionTitle" style="display: none;">2. Choisissez votre enfant</h2>
                <div id="student-grid-container" class="student-grid"></div>
            </main>
        </div>
        
        <!-- Vue Espace Enseignant - Connexion -->
        <div id="teacher-login-view" class="view" style="display: none;">
            <header>
                <button class="back-button">&larr;</button>
                <h1 data-translate="teacherLoginTitle">AccÃ¨s Enseignant</h1>
            </header>
            <main>
                <form id="teacher-login-form" class="login-form">
                    <input type="text" id="username" data-translate-placeholder="usernamePlaceholder" placeholder="Nom d'utilisateur" required>
                    <input type="password" id="password" data-translate-placeholder="passwordPlaceholder" placeholder="Mot de passe" required>
                    <button type="submit" data-translate="loginButton">Connexion</button>
                    <p id="login-error" class="error-message"></p>
                </form>
            </main>
        </div>

        <!-- Vue Tableau de Bord de l'Ã‰lÃ¨ve -->
        <div id="student-dashboard-view" class="view" style="display: none;">
            <header>
                <button class="back-button">&larr;</button>
                <h1 id="student-name-header"></h1>
            </header>
            <main>
                <div class="profile-summary">
                    <div class="student-info">
                        <img src="" alt="Photo Ã©lÃ¨ve" class="student-photo">
                        <div class="star-rating" id="star-rating"></div>
                        <div id="daily-progress-note" class="daily-progress-note" aria-live="polite"></div>
                        <div class="student-of-week" id="student-of-week-banner" data-translate="studentOfTheWeek">Ã‰lÃ¨ve de la semaine</div>
                    </div>
                    <div class="weekly-stats">
                        <h3 class="stat-title">ğŸ“ˆ <span data-translate="overallWeeklyProgress">Progression gÃ©nÃ©rale</span></h3>
                        <div class="progress-bar-container">
                            <div class="progress-bar" id="overall-progress-bar"></div>
                            <span id="overall-progress-text">0%</span>
                        </div>
                    </div>
                </div>
                <div class="dashboard-nav">
                    <button id="prev-day-btn" class="nav-arrow">&larr; <span data-translate="previousDay">Jour PrÃ©cÃ©dent</span></button>
                    <h2 id="homework-date"></h2>
                    <button id="next-day-btn" class="nav-arrow"><span data-translate="nextDay">Jour Suivant</span> &rarr;</button>
                </div>
                <div class="homework-grid" id="homework-grid"></div>
            </main>
        </div>
        
        <!-- Vue Tableau de Bord Enseignant -->
        <div id="teacher-dashboard-view" class="view" style="display: none;">
            <header>
                <button class="back-button">&larr;</button>
                <h1 data-translate="teacherDashboardTitle">Tableau de Bord Enseignant</h1>
            </header>
            <main>
                <div id="admin-upload-section" class="upload-section" style="display: none;">
                    <h3 class="section-title">ğŸ“… <span data-translate="updateSchedule">Mettre Ã  jour le planning</span></h3>
                    <input type="file" id="excel-file-input" accept=".xlsx, .xls, .xlsb, .csv">
                    <button id="upload-excel-btn" class="role-button" data-translate="uploadButton">Charger et Mettre Ã  jour</button>
                    <p id="upload-status"></p>
                </div>
                <div class="teacher-main-content">
                    <h2 class="section-title" data-translate="teacherSelectTitle">1. Choisissez votre nom</h2>
                    <div id="teacher-icons-container" class="teacher-icons-container"></div>
                    <h2 class="section-title" id="week-selection-title" style="display: none;">2. <span data-translate="weekSelectionTitle">Choisissez une semaine</span></h2>
                    <div id="week-buttons-container" class="week-buttons-container"></div>
                    <h2 class="section-title" id="homework-cards-title" style="display: none;">3. <span data-translate="homeworkToEvaluate">Choisissez un devoir Ã  Ã©valuer</span></h2>
                    <div id="homework-cards-container" class="homework-cards-container"></div>
                    <div id="teacher-evaluation-section" style="display: none;">
                        <h2 class="section-title">4. <span data-translate="studentEvaluationTitle">Ã‰valuez les Ã©lÃ¨ves</span></h2>
                        <div id="teacher-table-container"></div>
                    </div>
                </div>
                <!-- MODIFICATION: Ajout d'un champ pour le commentaire -->
                <div id="admin-photo-section" class="upload-section" style="display: none; margin-top: 30px; background-color: #e9f5ff;">
                    <h3 class="section-title">ğŸ–¼ï¸ <span data-translate="adminPhotoTitle">Ajouter une Photo de FÃ©licitations</span></h3>
                    <input type="text" id="photo-url-input" placeholder="Collez le lien de l'image ici (lh3.googleusercontent.com)...">
                    <input type="text" id="photo-comment-input" placeholder="Ajoutez un commentaire (optionnel)...">
                    <button id="submit-photo-btn" class="role-button" data-translate="saveButton">Enregistrer</button>
                    <p id="photo-status"></p>
                </div>
                
                <!-- Photo de cÃ©lÃ©bration 2 -->
                <div id="admin-photo2-section" class="upload-section" style="display: none; margin-top: 30px; background-color: #fff9e6;">
                    <h3 class="section-title">ğŸŒŸ <span data-translate="adminPhoto2Title">Ajouter une Photo de CÃ©lÃ©bration 2</span></h3>
                    <input type="text" id="photo2-url-input" placeholder="Collez le lien de l'image ici (lh3.googleusercontent.com)...">
                    <input type="text" id="photo2-comment-input" placeholder="Ajoutez un commentaire (optionnel)...">
                    <button id="submit-photo2-btn" class="role-button" data-translate="saveButton">Enregistrer</button>
                    <p id="photo2-status"></p>
                </div>
                
                <!-- Photo de cÃ©lÃ©bration 3 -->
                <div id="admin-photo3-section" class="upload-section" style="display: none; margin-top: 30px; background-color: #f0fff0;">
                    <h3 class="section-title">ğŸ† <span data-translate="adminPhoto3Title">Ajouter une Photo de CÃ©lÃ©bration 3</span></h3>
                    <input type="text" id="photo3-url-input" placeholder="Collez le lien de l'image ici (lh3.googleusercontent.com)...">
                    <input type="text" id="photo3-comment-input" placeholder="Ajoutez un commentaire (optionnel)...">
                    <button id="submit-photo3-btn" class="role-button" data-translate="saveButton">Enregistrer</button>
                    <p id="photo3-status"></p>
                </div>
            </main>
        </div>
    </div>

    <!-- Bouton retour Ã  l'accueil -->
    <a href="/" style="position: fixed; top: 20px; left: 20px; z-index: 10000; background: white; padding: 12px 20px; border-radius: 10px; text-decoration: none; color: #f5576c; font-weight: 600; box-shadow: 0 5px 15px rgba(0,0,0,0.2); display: flex; align-items: center; gap: 8px; transition: all 0.3s ease;">
        <i class="ri-home-line"></i> Accueil
    </a>
    <script src="js/devoirs.js"></script>
</body>
</html>
